# Phase 1.4: Governance Layer Architecture

## Overview

This document defines the 4-layer governance architecture that balances automation efficiency with human oversight and constitutional safeguards.

## Governance Layer Model

```
┌─────────────────────────────────────────────────────────────────┐
│                    LAYER 4: CONSTITUTIONAL                       │
│  Supermajority (67%+) │ Human only │ Protocol-level changes     │
├─────────────────────────────────────────────────────────────────┤
│                    LAYER 3: HUMAN-IN-LOOP                        │
│  Majority vote │ Agents assist │ Significant decisions          │
├─────────────────────────────────────────────────────────────────┤
│                    LAYER 2: AGENTIC + OVERSIGHT                  │
│  Agent proposes │ Human approves/overrides │ Routine operations │
├─────────────────────────────────────────────────────────────────┤
│                    LAYER 1: FULLY AUTOMATED                      │
│  100% automated │ No human required │ Monitoring & alerts        │
└─────────────────────────────────────────────────────────────────┘
```

## Layer Specifications

### Layer 1: Fully Automated
| Attribute | Value |
|-----------|-------|
| **Delegation** | Smart contracts execute autonomously |
| **Automation** | 100% |
| **Human Role** | None (monitoring only) |
| **Examples** | Price monitoring, data validation, metric computation |
| **Reversibility** | Automatic (no state changes) |
| **Confidence Threshold** | N/A (deterministic) |

**Suitable Operations:**
- Read-only state queries
- Statistical computations
- Alert generation
- Report compilation
- Dashboard updates

### Layer 2: Agentic + Oversight
| Attribute | Value |
|-----------|-------|
| **Delegation** | Agents propose, humans can override |
| **Automation** | 85%+ (with override window) |
| **Human Role** | Review and override if needed |
| **Examples** | Credit class screening, routine proposals |
| **Reversibility** | Before execution (override window) |
| **Confidence Threshold** | 0.85 |

**Suitable Operations:**
- Credit class application pre-screening
- Standard governance proposal submission
- Currency allowlist additions (standard criteria)
- Routine parameter adjustments
- Service milestone approvals

**Override Mechanism:**
```yaml
override_window:
  duration: 24h (standard), 72h (significant)
  trigger: human_intervention OR timeout
  if_no_override: auto_execute
  if_override: human_decision_takes_precedence
```

### Layer 3: Human-in-Loop
| Attribute | Value |
|-----------|-------|
| **Delegation** | Humans decide, agents assist |
| **Automation** | ~50% (analysis and recommendation) |
| **Human Role** | Final decision authority |
| **Examples** | Large grants, contested approvals |
| **Reversibility** | Before human decision |
| **Confidence Threshold** | N/A (human judgment) |

**Suitable Operations:**
- Community pool spend proposals (>50k REGEN)
- Contested credit class applications
- Novel governance proposals
- Dispute resolution
- Exception handling

**Agent Assistance:**
- Provide analysis and recommendations
- Compile relevant information
- Track deliberation progress
- Document decision rationale

### Layer 4: Constitutional
| Attribute | Value |
|-----------|-------|
| **Delegation** | Supermajority governance only |
| **Automation** | 0% (informational only) |
| **Human Role** | Full authority |
| **Examples** | Protocol upgrades, governance parameter changes |
| **Reversibility** | Requires new governance proposal |
| **Threshold** | 67% supermajority |

**Suitable Operations:**
- Software upgrades
- Governance parameter changes
- Constitutional amendments
- Emergency responses
- Mechanism design changes

## Decision Routing Logic

```yaml
decision_router:
  evaluate:
    - decision_type
    - economic_impact
    - precedent_status
    - agent_confidence
    - community_contention

  routing_rules:
    layer_1:
      conditions:
        - operation_type: "read_only" OR "informational"
        - state_change: false

    layer_2:
      conditions:
        - operation_type: "routine"
        - agent_confidence: >= 0.85
        - economic_impact: < threshold_medium
        - precedent_exists: true
        - community_contention: < 0.3

    layer_3:
      conditions:
        - operation_type: "significant"
        - OR agent_confidence: < 0.85
        - OR economic_impact: >= threshold_medium
        - OR precedent_exists: false
        - OR community_contention: >= 0.3

    layer_4:
      conditions:
        - operation_type: "constitutional"
        - OR affects_governance_params: true
        - OR requires_protocol_change: true
```

## Escalation Paths

```
Layer 1 ──(anomaly detected)──► Layer 2
Layer 2 ──(low confidence)────► Layer 3
Layer 2 ──(human override)────► Layer 3
Layer 3 ──(constitutional)────► Layer 4
Any Layer ──(emergency)───────► Layer 4 + Core Team
```

## Governance Parameters

### Current On-Chain Parameters
| Parameter | Value | Layer |
|-----------|-------|-------|
| Voting Period | 604,800s (7 days) | Layer 4 |
| Quorum | 33.4% | Layer 4 |
| Pass Threshold | 50% | Layer 3-4 |
| Veto Threshold | 33.4% | Layer 3-4 |
| Deposit | 200 REGEN | Layer 2+ |

### Proposed Agent Parameters
| Parameter | Value | Purpose |
|-----------|-------|---------|
| Confidence Threshold (L2) | 0.85 | Minimum for auto-propose |
| Override Window (L2) | 24h standard | Human review time |
| Escalation Threshold | 0.70 | Trigger human review |
| Contention Threshold | 0.30 | Community sentiment split |

## Implementation Roadmap

1. **Phase 3.1**: Implement Layer 1 (monitoring, alerting)
2. **Phase 3.2**: Implement Layer 2 (agent proposals with override)
3. **Phase 3.3**: Enhance Layer 3 (decision support tools)
4. **Phase 4**: Operationalize full 4-layer system
